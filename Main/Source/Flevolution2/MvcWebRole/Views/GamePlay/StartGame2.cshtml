@{
    ViewBag.Title = "StartGame2";
}

<h2>StartGame2</h2>

<div>
    <div data-bind="foreach: characters">
        <div style="float: left">
            <table>
                <tr>
                    <td>
                        <div style="float: left">
                            <img src="~/Images/gold.png" width="24" height="24" alt="Gold" />
                        </div>
                        <div style="float: left">A</div>
                        <div style="float: left">
                            <img src="~/Images/blackmail.png" width="24" height="24" alt="Blackmail" />
                        </div>
                        <div style="float: left">B</div>
                        <div style="float: left">
                            <img src="~/Images/force.png" width="24" height="24" alt="Force" />
                        </div>
                        <div style="float: left"></div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <img data-bind="attr: { src: imagepath, alt: name }" alt="Character" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong data-bind="text: name" />
                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>

@Html.RadioButton

<div style="clear: both; ">
    <table>
    <tr><td>Gold</td><td style="text-align: left"><input data-bind="click: selectCurrency" type="radio" name="currencySelection" style="width:30px" title="Gold" /></td>
    <td>Blackmail</td><td style="text-align: left"> <input data-bind="click: selectCurrency" style="width:30px" name="currencySelection" type="radio" title="Blackmail" /></td>
    <td>Force</td><td style="text-align: left"> <input data-bind="click: selectCurrency" style="width:30px" name="currencySelection" type="radio" title="Force" /></td></tr>
    </table>
</div>

<script type="text/javascript">
    function Character(item) {
        var self = this;
        self.id = item.Id;        
        self.name = item.Name;
        //self.imagepath = "../Images/char_" + item.Name + ".jpg";
        self.imagepath = "../Images/char_general.jpg";
    }

    function CharacterViewModel() {
        var self = this;
        self.characters = ko.observableArray([]);

        // Load characters
        $.post("/GamePlay/GetCharacters", null, function (allServerCharacters) {
            var mappedCharacters = $.map(allServerCharacters, function (serverCharacter) { return new Character(serverCharacter); });
            self.characters(mappedCharacters);
        });

        // Event handler for currency selection
        self.selectCurrency = function () {
            $.post("/GamePlay/SetCurrentCurrency", null)
        }
    }

    ko.applyBindings(new CharacterViewModel());

</script>